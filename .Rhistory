geom_bar(aes(y=third,fill=third), position = "stack") +
geom_bar(aes(y=below_third,fill=below_third), position = "stack") +
labs(x="Frequency", y="Features") + scale_fill_manual(values=cc, guide="none") + theme_bw()
fplot
fplot <- ggplot(all_vars) +
geom_bar(aes(y=all_features, x=first), position = "stack") +
geom_bar(aes(y=all_features, x=second), position = "stack") +
geom_bar(aes(y=all_features, x=third), position = "stack") +
geom_bar(aes(y=all_features, x=below_third), position = "stack") +
labs(x="Frequency", y="Features") + scale_fill_manual(values=cc, guide="none") + theme_bw()
fplot
fplot <- ggplot(all_vars) +
geom_bar(aes(y=all_features, x=first), position = "stack",stat='identity') +
geom_bar(aes(y=all_features, x=second), position = "stack", stat='identity') +
geom_bar(aes(y=all_features, x=third), position = "stack", stat='identity') +
geom_bar(aes(y=all_features, x=below_third), position = "stack") +
labs(x="Frequency", y="Features") + scale_fill_manual(values=cc, guide="none") + theme_bw()
fplot
fplot <- ggplot(all_vars) +
geom_bar(aes(x=all_features, y=first), position = "stack",stat='identity') +
geom_bar(aes(x=all_features, y=second), position = "stack", stat='identity') +
geom_bar(aes(x=all_features, y=third), position = "stack", stat='identity') +
geom_bar(aes(x=all_features, y=below_third), position = "stack") +
labs(x="Frequency", y="Features") + scale_fill_manual(values=cc, guide="none") + theme_bw()
fplot
fplot <- ggplot(all_vars) +
geom_bar(aes(x=all_features, y=first), position = "stack",stat='identity') +
geom_bar(aes(x=all_features, y=second), position = "stack", stat='identity') +
geom_bar(aes(x=all_features, y=third), position = "stack", stat='identity') +
geom_bar(aes(x=all_features, y=below_third), position = "stack")
fplot
data <- data.frame(specie,condition,value)
specie <- c(rep("sorgho" , 3) , rep("poacee" , 3) , rep("banana" , 3) , rep("triticum" , 3) )
condition <- rep(c("normal" , "stress" , "Nitrogen") , 4)
value <- abs(rnorm(12 , 0 , 15))
data <- data.frame(specie,condition,value)
View(data)
View(data)
View(all_vars)
View(all_vars)
View(total)
View(total)
remove(total)
View(all_vars)
View(all_vars)
n <- nrow(all_vars)
#plot with top 3
total <- c()
for (x in all_vars){
total <- append(total,rep(x,4))
}
b <- as.data.frame(total)
View(b)
View(b)
#plot with top 3
total <- c()
for (x in all_vars$all_features){
total <- append(total,rep(x,4))
}
remove(b)
total <- as.data.frame(total)
View(total)
View(total)
total$importance <- rep(lvls,4)
total$importance <- rep(lvls,22)
View(total)
View(total)
match(all_vars$all_features[1],total$total)
match(all_vars$all_features[2],total$total)
match(all_vars$all_features[3],total$total)
total$frequency <- 0
i <- 1
while (i <= rnow(all_vars)){
j <- match(all_vars$all_features[i],total$total)
total$frequency[j] <- all_vars$first[j]
total$frequency[j+1] <- all_vars$second[j]
total$frequency[j+2] <- all_vars$third[j]
total$frequency[j+3] <- all_vars$below_third[j]
i <- i + 1
}
i <- 1
while (i <= nrow(all_vars)){
j <- match(all_vars$all_features[i],total$total)
total$frequency[j] <- all_vars$first[j]
total$frequency[j+1] <- all_vars$second[j]
total$frequency[j+2] <- all_vars$third[j]
total$frequency[j+3] <- all_vars$below_third[j]
i <- i + 1
}
View(total)
View(total)
View(all_vars)
View(all_vars)
nrow(all_vars)
i <- 21
j <- match(all_vars$all_features[i],total$total)
j
all_vars$first[j]
total$frequency <- 0
i <- 1
while (i <= nrow(all_vars)){
j <- match(all_vars$all_features[i],total$total)
total$frequency[j] <- all_vars$first[i]
total$frequency[j+1] <- all_vars$second[i]
total$frequency[j+2] <- all_vars$third[i]
total$frequency[j+3] <- all_vars$below_third[i]
i <- i + 1
}
View(total)
View(total)
fplot <- ggplot(all_vars, aes(fill=importance, y=total, x=frequency)) +
geom_bar(position="stack", stat="identity")
fplot
fplot <- ggplot(all_vars, aes(fill=importance, y=frequency, x=total)) +
geom_bar(position="stack", stat="identity")
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=total)) +
geom_bar(position="stack", stat="identity")
fplot
fplot
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=total)) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total, level = fct_infreq(all_features)))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fct_infreq(all_features)
View(all_vars)
View(all_vars)
x <- all_vars$all_features
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total, level = all_vars$all_features))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
i <- match(featList[1,2],all_vars$all_features)
j <- match(featList[2,2],all_vars$all_features)
View(featList)
k <- match(featList[3,2],all_vars$all_features)
m <- 4
i <- match(featList[m,2],all_vars$all_features)
m <- m + 1
i <- match(featList[m,2],all_vars$all_features)
View(featList)
m <- m + 1
i <- match(featList[m,2],all_vars$all_features)
m <- m + 1
i <- match(featList[m,2],all_vars$all_features)
m <- m + 1
i <- match(featList[m,2],all_vars$all_features)
m <- 12
nrow(featList)
i <- match(featList[m,2],all_vars$all_features)
m <- m + 1
while (m <= nrow(featList)){
i <- match(featList[m,2],all_vars$all_features)
all_vars$below_third[i] <- all_vars$below_third[i] + 1
m <- m + 1
}
all_vars <- unique(all_features)
all_vars$first <-0
all_vars$second <- 0
all_vars$third <- 0
all_vars$below_third <- 0
all_vars$first <-0
all_vars$second <- 0
all_vars$third <- 0
all_vars$below_third <- 0
f <- listFile[1]
f <- listFiles[1]
featList <- read.csv(f)
i <- match(featList[1,2],all_vars$all_features)
all_vars$first[i] <- all_vars$first[i] + 1
j <- match(featList[2,2],all_vars$all_features)
all_vars$second[j] <- all_vars$second[j] + 1
k <- match(featList[3,2],all_vars$all_features)
all_vars$third[k] <- all_vars$third[j] + 1
m <- 4
while (m <= nrow(featList)){
i <- match(featList[m,2],all_vars$all_features)
all_vars$below_third[i] <- all_vars$below_third[i] + 1
m <- m + 1
}
f <- listFiles[2]
featList <- read.csv(f)
View(featList)
View(featList)
i <- match(featList[1,2],all_vars$all_features)
all_vars$first[i] <- all_vars$first[i] + 1
j <- match(featList[2,2],all_vars$all_features)
all_vars$second[j] <- all_vars$second[j] + 1
k <- match(featList[3,2],all_vars$all_features)
all_vars$third[k] <- all_vars$third[j] + 1
for (f in listFiles){
featList <- read.csv(f)
i <- match(featList[1,2],all_vars$all_features)
all_vars$first[i] <- all_vars$first[i] + 1
j <- match(featList[2,2],all_vars$all_features)
all_vars$second[j] <- all_vars$second[j] + 1
k <- match(featList[3,2],all_vars$all_features)
all_vars$third[k] <- all_vars$third[k] + 1
m <- 4
while (m <= nrow(featList)){
i <- match(featList[m,2],all_vars$all_features)
all_vars$below_third[i] <- all_vars$below_third[i] + 1
m <- m + 1
}
}
all_vars <- unique(all_features)
all_vars$first <-0
all_vars$second <- 0
all_vars$third <- 0
all_vars$below_third <- 0
for (f in listFiles){
featList <- read.csv(f)
i <- match(featList[1,2],all_vars$all_features)
all_vars$first[i] <- all_vars$first[i] + 1
j <- match(featList[2,2],all_vars$all_features)
all_vars$second[j] <- all_vars$second[j] + 1
k <- match(featList[3,2],all_vars$all_features)
all_vars$third[k] <- all_vars$third[k] + 1
m <- 4
while (m <= nrow(featList)){
i <- match(featList[m,2],all_vars$all_features)
all_vars$below_third[i] <- all_vars$below_third[i] + 1
m <- m + 1
}
}
View(all_vars)
View(all_vars)
#plot with top 3
total <- c()
lvls <- c("first","second","third","below third")
n <- nrow(all_vars)
for (x in all_vars$all_features){
total <- append(total,rep(x,4))
}
total <- as.data.frame(total)
total$importance <- rep(lvls,22)
total$frequency <- 0
i <- 1
while (i <= nrow(all_vars)){
j <- match(all_vars$all_features[i],total$total)
total$frequency[j] <- all_vars$first[i]
total$frequency[j+1] <- all_vars$second[i]
total$frequency[j+2] <- all_vars$third[i]
total$frequency[j+3] <- all_vars$below_third[i]
i <- i + 1
}
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total, level = all_vars$all_features))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
all_vars$sum <- all_vars$first + all_vars$second + all_vars$third + all_vars$below_third
View(all_vars)
View(all_vars)
View(total)
View(total)
total_x <- merge(total, all_vars$sum)
View(total_x)
View(total_x)
total_x <- merge(total, all_vars)
total_x <- merge(total, all_vars)
View(total_x)
View(total_x)
colnames(total$total) <- c("all_features")
colnames(total) <- c("all_features","importance","frequency")
View(total)
View(total)
total_x
total_x <- merge(total, all_vars, by=all_features)
total_x <- rbind(total, all_vars)
total_x <- rbind(total, all_vars)
total_x <- merge(total, all_vars, by=c("all_features"))
View(total_x)
View(total_x)
total_x
total_x
View(total_x)
View(total_x)
total <- merge(total, all_vars, by=c("all_features"))
remove(total_x)
total <- total[order(total$sum, decreasing = F),]
View(total)
View(total)
total <- total[order(total$sum, decreasing = T),]
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total, level = all_features))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total, level = sum))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total)) +
coord_flip()
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total) +
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(total)) +
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=total) +
coord_flip()
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=total)) +
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=total)) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(all_features, levels = sum))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=factor(all_features, level = sum))) +
geom_bar(position="stack", stat="identity") +
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = sum) +
coord_flip()
fplot
level_order <- all_vars$all_features
level_order <- all_vars$all_features[order(total$sum, decreasing = T),]
all_vars <- all_vars[order(all_vars$sum, decreasing = T),]
level_order <- all_vars$all_features
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
coord_flip()
fplot
importance_order <- c("first","second","third","below third")
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order)
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order)+
coord_flip()
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order) +
coord_flip() +
labs(y = "Features", guide="Position")
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order) +
coord_flip() +
labs(x = "Features", color="Position")
fplot
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order) +
coord_flip() +
labs(x = "Features", fill="Position")
fplot
gsave(paste(getwd(),dir,"/featurePlot_Top3.png",sep=""), width=7, height=5)
ggsave(paste(getwd(),dir,"/featurePlot_Top3.png",sep=""), width=7, height=5)
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order) +
coord_flip() +
labs(x = "Features", y="Frequency",fill="Position")
fplot
ggsave(paste(getwd(),dir,"/featurePlot_Top3.png",sep=""), width=7, height=5)
#dir <- "/MR_RFnoNormcv2_2"
dir <- "/MR_Hybridcv2_2"
rootPath=paste(getwd(),dir,sep="")
rootPath=paste(getwd(),dir,sep="")
packages <- c("dplyr","readxl","randomForest","caret","Metrics","ggplot2",
"tidyr","reshape2","RColorBrewer")
lapply(packages, library, character.only=TRUE)
#dir <- "/MR_RFnoNormcv2_2"
dir <- "/MR_Hybridcv2_2"
rootPath=paste(getwd(),dir,sep="")
listFiles=list.files(rootPath,recursive=TRUE,full.names=TRUE)
featFiles=grepl("features",listFiles)
all_features <- c() #list of all feature occurences for all field-years
listFiles <- listFiles[featFiles]
listFiles
#listFiles <- listFiles[c(1:5,7,8,10,11,13,14,16,17,19,21,23,25,27,28,29)]
listFiles <- listFiles[c(1:5,7,8,10,11:13,15,16,18,20,21:25)] #hybrid
for (f in listFiles){
featList <- read.csv(f)
all_features <- append(all_features,featList[,2])
}
all_features <- as.data.frame(all_features)
all_vars <- unique(all_features)
all_vars$first <-0
all_vars$second <- 0
all_vars$third <- 0
all_vars$below_third <- 0
for (f in listFiles){
featList <- read.csv(f)
i <- match(featList[1,2],all_vars$all_features)
all_vars$first[i] <- all_vars$first[i] + 1
j <- match(featList[2,2],all_vars$all_features)
all_vars$second[j] <- all_vars$second[j] + 1
k <- match(featList[3,2],all_vars$all_features)
all_vars$third[k] <- all_vars$third[k] + 1
m <- 4
while (m <= nrow(featList)){
i <- match(featList[m,2],all_vars$all_features)
all_vars$below_third[i] <- all_vars$below_third[i] + 1
m <- m + 1
}
}
#plot stacked with top 3
total <- c()
lvls <- c("first","second","third","below third")
n <- nrow(all_vars)
for (x in all_vars$all_features){
total <- append(total,rep(x,4))
}
total <- as.data.frame(total)
total$importance <- rep(lvls,22)
total$frequency <- 0
i <- 1
while (i <= nrow(all_vars)){
j <- match(all_vars$all_features[i],total$total)
total$frequency[j] <- all_vars$first[i]
total$frequency[j+1] <- all_vars$second[i]
total$frequency[j+2] <- all_vars$third[i]
total$frequency[j+3] <- all_vars$below_third[i]
i <- i + 1
}
colnames(total) <- c("all_features","importance","frequency")
all_vars$sum <- all_vars$first + all_vars$second + all_vars$third + all_vars$below_third
total <- merge(total, all_vars, by=c("all_features"))
total <- total[order(total$sum, decreasing = T),]
all_vars <- all_vars[order(all_vars$sum, decreasing = T),]
level_order <- all_vars$all_features
importance_order <- c("first","second","third","below third")
fplot <- ggplot(total, aes(fill=importance, y=frequency, x=all_features)) +
geom_bar(position="stack", stat="identity") +
scale_x_discrete(limits = level_order) +
scale_fill_discrete(limits = importance_order) +
coord_flip() +
labs(x = "Features", y="Frequency",fill="Position")
fplot
ggsave(paste(getwd(),dir,"/featurePlot_Top3.png",sep=""), width=7, height=5)
packages <- c("dplyr","readxl","ggplot2","tidyr","reshape2","RColorBrewer","stringr")
lapply(packages, library, character.only=TRUE)
dir <- "/MR_RFnoNormcv2_2"
#gridded data
data <- read.csv(paste(getwd(),dir,"/allFieldsnoNormcv2_2.csv",sep=""))
data$year <- as.numeric(str_sub(data$Label,-4,-1))
View(data)
View(data)
#by field
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Field", y="Yield (t/ha.)",fill=year) +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_y_continuous(breaks = seq(25,65, by=5))
View(data)
View(data)
View(data)
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=year,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Year", y="Yield (t/ha.)") +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_x_continuous(breaks = seq(2015,2021, by=1)) +
scale_y_continuous(breaks = seq(25,65, by=5))
yld_trnd
#by field
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Field", y="Yield (t/ha.)",fill=year) +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_y_continuous(breaks = seq(25,65, by=5))
#by field
yld_trnd <- ggplot(data, aes(x=Label,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Field", y="Yield (t/ha.)",fill=year) +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_y_continuous(breaks = seq(25,65, by=5))
#by field
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Field", y="Yield (t/ha.)",fill="Year") +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_y_continuous(breaks = seq(25,65, by=5))
yld_trnd
#by field
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Field", y="Yield (t/ha.)",fill="Year") +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_x_continuous(breaks = seq(2015,2021, by=1)) +
scale_y_continuous(breaks = seq(25,65, by=5))
#by field
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Field", y="Yield (t/ha.)",fill="Year") +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_x_continuous(breaks = seq(2015,2021, by=1)) +
scale_y_continuous(breaks = seq(25,65, by=5))
#by field
yld_trnd <- ggplot(data, aes(x=year,y=Actual, group=Label,fill=year)) + geom_boxplot() +
theme_bw() + labs(x="Year", y="Yield (t/ha.)") +
scale_fill_gradientn(colours=RColorBrewer::brewer.pal(6,"Paired"), guide="none") +
scale_x_continuous(breaks = seq(2015,2021, by=1)) +
scale_y_continuous(breaks = seq(25,65, by=5))
yld_trnd
ggsave(paste(getwd(),dir,"/yieldBoxPlot_byFld.png",sep=""), width=7, height=5)
